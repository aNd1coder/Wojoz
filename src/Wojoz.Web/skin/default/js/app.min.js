var m=document.uniqueID&&document.compatMode&&!window.XMLHttpRequest&&document.execCommand;try{!!m&&m("BackgroundImageCache",false,true)}catch(oh){}var SysEC={},ua=navigator.userAgent.toLowerCase(),s;(s=ua.match(/msie ([\d.]+)/))?(SysEC.ie=s[1]):(s=ua.match(/firefox\/([\d.]+)/))?(SysEC.firefox=s[1]):(s=ua.match(/chrome\/([\d.]+)/))?(SysEC.chrome=s[1]):(s=ua.match(/opera.([\d.]+)/))?(SysEC.opera=s[1]):(s=ua.match(/version\/([\d.]+).*safari/))?(SysEC.safari=s[1]):0;var version;if(SysEC.ie)version="ie ie_"+SysEC.ie.substring(0,1);if(SysEC.firefox)version="firefox firefox_"+SysEC.firefox.substring(0,1);if(SysEC.chrome)version="chrome chrome_"+SysEC.chrome.substring(0,1);if(SysEC.opera)version="opera opera_"+SysEC.opera.substring(0,1);if(SysEC.safari)version="safari safari_"+SysEC.safari.substring(0,1);document.documentElement.className=version;function StringBuilder(a){this.strings=[""];this.Append(a)}StringBuilder.prototype.Append=function(a){a&&this.strings.push(a)};StringBuilder.prototype.Clear=function(){this.strings.length=1};StringBuilder.prototype.ToString=function(){return this.strings.join("")};String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"gm"),b)};window.usingNamespace=function(b){var a=window;if(!(typeof b==="string"&&b.length!=0))return a;for(var f=a,e=b.split("."),c=0;c<e.length;c++){var d=e[c];if(!a[d])a[d]={};f=a=a[d]}return f};var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];usingNamespace("Mstar.Utils").String={IsNullOrEmpty:function(a){return!(typeof a==="string"&&a.length!=0)},Trim:function(a){return a.replace(/^\s+|\s+$/g,"")},TrimStart:function(c,a){if($String.IsNullOrEmpty(a))a="\\s";var b=new RegExp("^"+a+"*","ig");return c.replace(b,"")},TrimEnd:function(c,a){if($String.IsNullOrEmpty(a))a="\\s";var b=new RegExp(a+"*$","ig");return c.replace(b,"")},Camel:function(a){return a.toLowerCase().replace(/\-([a-z])/g,function(b,a){return a.toUpperCase()})},Format:function(b){if(arguments.length==0)return null;var a=Array.prototype.slice.call(arguments,1);return b.replace(/\{(\d+)\}/g,function(c,b){return a[b]})},ReplaceNullOrEmptyBySymbol:function(a,b){return $String.IsNullOrEmpty(a)?b:a},Repeat:function(e,d,a){a=$String.IsNullOrEmpty(a)?",":a;for(var b=0,c=new Array(d);b<d;b++)c[b]=e;return c.join(a)},IsEqual:function(b,a){return b==a?true:false},IsNotEqual:function(b,a){return b==a?false:true},ActualLength:function(a){return $.trim(a).replace(/[\u4e00-\u9fa5]/,"**").length},SetLen:function(a,b){return $String.ActualLength(a)<b?a:a.substr(0,i)+"..."},MaxLengthKeyUp:function(c,a){var b=$(c).val();b>a&&$(c).val(b.substring(0,a))},TotalByteValidator:function(a){var b=a.attr("maxlength");Mstar.Utils.String.fCkByte(a,b)},MaxLengthKeyDown:function(b,a){return $(b).val().length>a?false:true},fCkByte:function(d,b){if(!$String.IsNullOrEmpty(d))for(var e=d.val()+"",c=0,a=0;a<e.length;a++){if(c>b)temp=a;if(e.charCodeAt(a)>127||e.charCodeAt(a)<0)c+=2;else c++;if(c>b){d[0].value=d[0].value.substr(0,a);alert("输入超出限制,最多可以输入"+b+"个字符或者"+b/2+"个汉字！");return}}},FormatNumber:function(j,h){for(var g=j?j.toString().split("."):["0"],f=h?h.split("."):[""],a="",c=g[0],e=f[0],b=c.length-1,i=false,d=e.length-1;d>=0;d--)switch(e.substr(d,1)){case"#":if(b>=0)a=c.substr(b--,1)+a;break;case"0":if(b>=0)a=c.substr(b--,1)+a;else a="0"+a;break;case",":i=true;a=","+a}if(b>=0)if(i)for(var k=c.length;b>=0;b--){a=c.substr(b,1)+a;if(b>0&&(k-b)%3==0)a=","+a}else a=c.substr(0,b+1)+a;a=a+".";c=g.length>1?g[1]:"";e=f.length>1?f[1]:"";b=0;for(var d=0;d<e.length;d++)switch(e.substr(d,1)){case"#":if(b<c.length)a+=c.substr(b++,1);break;case"0":if(b<c.length)a+=c.substr(b++,1);else a+="0"}return a.replace(/^,+/,"").replace(/\.$/,"")},Base64Encode:function(f){var a,c,e,b,d,g;e=f.length;c=0;a="";while(c<e){b=f.charCodeAt(c++)&255;if(c==e){a+=base64EncodeChars.charAt(b>>2);a+=base64EncodeChars.charAt((b&3)<<4);a+="==";break}d=f.charCodeAt(c++);if(c==e){a+=base64EncodeChars.charAt(b>>2);a+=base64EncodeChars.charAt((b&3)<<4|(d&240)>>4);a+=base64EncodeChars.charAt((d&15)<<2);a+="=";break}g=f.charCodeAt(c++);a+=base64EncodeChars.charAt(b>>2);a+=base64EncodeChars.charAt((b&3)<<4|(d&240)>>4);a+=base64EncodeChars.charAt((d&15)<<2|(g&192)>>6);a+=base64EncodeChars.charAt(g&63)}return a},Base64Decode:function(f){var h,g,b,d,a,e,c;e=f.length;a=0;c="";while(a<e){do h=base64DecodeChars[f.charCodeAt(a++)&255];while(a<e&&h==-1);if(h==-1)break;do g=base64DecodeChars[f.charCodeAt(a++)&255];while(a<e&&g==-1);if(g==-1)break;c+=String.fromCharCode(h<<2|(g&48)>>4);do{b=f.charCodeAt(a++)&255;if(b==61)return c;b=base64DecodeChars[b]}while(a<e&&b==-1);if(b==-1)break;c+=String.fromCharCode((g&15)<<4|(b&60)>>2);do{d=f.charCodeAt(a++)&255;if(d==61)return c;d=base64DecodeChars[d]}while(a<e&&d==-1);if(d==-1)break;c+=String.fromCharCode((b&3)<<6|d)}return c},Utf16to8:function(d){var b,c,e,a;b="";e=d.length;for(c=0;c<e;c++){a=d.charCodeAt(c);if(a>=1&&a<=127)b+=d.charAt(c);else if(a>2047){b+=String.fromCharCode(224|a>>12&15);b+=String.fromCharCode(128|a>>6&63);b+=String.fromCharCode(128|a>>0&63)}else{b+=String.fromCharCode(192|a>>6&31);b+=String.fromCharCode(128|a>>0&63)}}return b},Utf8to16:function(b){var c,a,g,e,d,f;c="";g=b.length;a=0;while(a<g){e=b.charCodeAt(a++);switch(e>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=b.charAt(a-1);break;case 12:case 13:d=b.charCodeAt(a++);c+=String.fromCharCode((e&31)<<6|d&63);break;case 14:d=b.charCodeAt(a++);f=b.charCodeAt(a++);c+=String.fromCharCode((e&15)<<12|(d&63)<<6|(f&63)<<0)}}return c}};usingNamespace("Mstar.Utils").Converter={ToInt:function(a,b){var b=b||0,a=$.trim(a);return!a||a.length==0?b:isNaN(parseInt(a))?b:parseInt(a)},ToFloat:function(a,b){var b=b||0,a=$.trim(a);return!a||a.length==0?b:isNaN(parseFloat(a))?b:parseFloat(a)}};usingNamespace("Mstar.Utils").Json={ToJson:function(a){try{return JSON.stringify(a)}catch(b){}return false},FromJson:function(a){try{return JSON.parse(a)}catch(b){return false}},FormatDate:function(b){if(b==null||b=="")return"";var i=b.replace("/Date(","").replace(")/",""),a=new Date(parseInt(i)),h,f,c,d,e,g;h=a.getFullYear();if(a.getMonth()<9)f="0"+(a.getMonth()+1);else f=a.getMonth()+1;if(a.getDate()<10)c="0"+a.getDate();else c=a.getDate();if(a.getHours()<10)d="0"+a.getHours();else d=a.getHours();if(a.getMinutes()<10)e="0"+a.getMinutes();else e=a.getMinutes();if(a.getSeconds()<10)g="0"+a.getSeconds();else g=a.getSeconds();return h+"-"+f+"-"+c+" "+d+":"+e+":"+g}};usingNamespace("Mstar").HttpUtility={UrlEncode:function(a){return escape(a).replace(/\*/g,"%2A").replace(/\+/g,"%2B").replace(/-/g,"%2D").replace(/\./g,"%2E").replace(/\//g,"%2F").replace(/@/g,"%40").replace(/_/g,"%5F")},UrlDecode:function(a){return unescape(a)}};var $Converter=Mstar.Utils.Converter,$String=Mstar.Utils.String,$Json=Mstar.Utils.Json,$Conf=Mstar.Conf,$CookieConfig=Mstar.Config.CookieConfig,$HttpUtility=Mstar.HttpUtility;usingNamespace("Mstar").State={Cookies:{Name:{Customer:"Customer",Product:"Product"},Set:function(h,b){var a="";if(typeof b=="string")a=escape(b);else if(typeof b=="object"){var e=Mstar.State.Cookies.ToJson(Mstar.State.Cookies.Get(h));if(e==false)e={};for(var f in b)eval("jsonv."+f+'="'+b[f]+'"');for(var f in e)a+=f+"="+escape(e[f])+"&";a=a.substring(0,a.length-1)}var g,l,d,j;try{var c=$CookieConfig[h];if(null!=c){d=$Conf.Domain;if(c.TopLevelDomain==false)d="";var k=$Converter.ToFloat(c.Expires);if(k>0){var i=new Date;i.setTime(i.getTime()+k*1e3);g=i}l=c.Path;j=c.SecureOnly}}catch(n){}var m=h+"="+a+(g?"; expires="+g.toGMTString():"")+"; path=/"+(d?"; domain="+d:"")+(j?"; secure":"");document.cookie=m},Remove:function(b){var a=new Date;a.setTime(a.getTime()-1);var c=Mstar.State.Cookies.Get(b);document.cookie=b+"="+c+"; expires="+a.toGMTString()},Clear:function(d){var b,c,e;try{var a;if(null!=(a=Mstar.Config.CookieConfig[d])){b=$Conf.Domain;c=a.Path;e=a.SecureOnly}}catch(f){}document.cookie=d+"="+(c?";path="+c:"")+(b?";domain="+b:"")+";expires=Thu, 01-Jan-1900 00:00:01 GMT"},Get:function(g,d){var e=new RegExp("(^| )"+g+"=([^;]*)(;|$)"),a=document.cookie.match(e);if(arguments.length==2)if(a!=null){var c,f=new RegExp("(^| |&)"+d+"=([^&]*)(&|$)"),b=a[2],b=b?b:document.cookie;return(c=b.match(f))?unescape(c[2]):""}else return"";else if(arguments.length==1)return a!=null?unescape(a[2]):""},ToJson:function(a){var a=a.replace(new RegExp("=","gi"),":'").replace(new RegExp("&","gi"),"',").replace(new RegExp(";\\s","gi"),"',");return eval("({"+a+(a.length>0?"'":"")+"})")}}};var $State=Mstar.State.Cookies;usingNamespace("Mstar").Url={BuildCurrentUrl:function(a){return Environment.Url+"/"+$String.TrimStart(a,"/")},BuildUrl:function(a){return"/"+$String.TrimStart(a,"/")},BuildProductUrl:function(a,b){return $Conf.ProductUrlRewriteName+"-c"+a+"-"+b+".htm"},BuildImageUrl:function(){sResult=$Conf.UrlPathMappings.WWWSite;return sResult+$String.TrimStart(sPagePath,"/")},ParseUrl:function(b){var a=document.createElement("a");a.href=b;return{source:b,protocol:a.protocol.replace(":",""),host:a.hostname,port:a.port,query:a.search,params:function(){for(var e={},c=a.search.replace(/^\?/,"").split("&"),f=c.length,b=0,d;b<f;b++){if(!c[b])continue;d=c[b].split("=");e[d[0]]=d[1]}return e}(),file:(a.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:a.hash.replace("#",""),path:a.pathname.replace(/^([^\/])/,"/$1"),relative:(a.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:a.pathname.replace(/^\//,"").split("/")}}};var $Url=Mstar.Url;usingNamespace("Mstar").Resource={BuildImage:function(a){return Environment.ResourceUrl+a},BuildProductImage:function(b,a){return $Conf.ProductImageUrl+b+"/"+a},BuildContent:function(a){return eval("Mstar.ResourceConfig.StringResourceConfig."+a)},BuildContent:function(){for(var c=arguments,b=eval("Mstar.ResourceConfig.StringResourceConfig."+arguments[0]),a=1;a<c.length;a++){var d=new RegExp("\\{"+(a-1)+"\\}","gm");b=b.replace(d,arguments[a])}return b},DefaultImage:{size50:$Conf.ProductImageUrl+"50.jpg",size80:$Conf.ProductImageUrl+"80.jpg",size130:$Conf.ProductImageUrl+"130.jpg",size160:$Conf.ProductImageUrl+"160.jpg",size200:$Conf.ProductImageUrl+"200.jpg",size280:$Conf.ProductImageUrl+"280.jpg"}};var $Resource=Mstar.Resource;usingNamespace("Mstar").QueryString={Get:function(a){a=a.toLowerCase();var c=Mstar.QueryString.Parse(),b=c[a];return b!=null?b:""},Set:function(a,c){a=a.toLowerCase();var b=Mstar.QueryString.Parse();b[a]=$HttpUtility.UrlEncode(c);return Mstar.QueryString.ToString(b)},Parse:function(a){var c={};if(a==null)a=location.search.substring(1,location.search.length);if(a.length==0)return c;a=a.replace(/\+/g," ");for(var e=a.split("&"),d=0;d<e.length;d++){var b=e[d].split("="),f=b[0].toLowerCase(),g=b.length==2?b[1]:f;c[f]=g}return c},ToString:function(b){if(b==null)b=Mstar.QueryString.Parse();var a="";for(var c in b){if(a=="")a="?";a=a+c+"="+b[c]+"&"}a=a.substring(0,a.length-1);return a}};var $QueryString=Mstar.QueryString;usingNamespace("Mstar").Form={reset:function(a){var b=$("#"+a);b.reset()},submit:function(a){var b=$("#"+a);b.submit()}};var $Form=Mstar.Form,MessageType={Info:"0",Warning:"1",Error:"2"};usingNamespace("Mstar.Ajax").Loading={Begin:function(b,e,h){b=!$String.IsNullOrEmpty(b)?b:"#globalLoader";var a=$(""+b+""),c=$(""+e+"");a.html(h);var d=c.offset(),i=c.width(),f=c.height(),j=a.width(),g=a.height(),k=d.left+(i-j)/2,l=d.top+(f-g)/2;a.css("left",k);a.css("top",l);a.show()},End:function(a){a=!$String.IsNullOrEmpty(a)?a:"#globalLoader";setTimeout("$('"+a+"').hide()",500)}};var $Loading=Mstar.Ajax.Loading;usingNamespace("Mstar").Dom={AvailWidth:function(){var c,a,b;a=document.documentElement.clientWidth;b=document.body.clientWidth;if(b>a)c=b+20;else c=a;return c},AvailHeight:function(){var c,a,b;a=document.documentElement.clientHeight;b=document.body.clientHeight;if(b>a)c=b+30;else c=a;return c+1e3},ScrollLeft:function(){return Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)},ScrollTop:function(){return Math.max(document.documentElement.scrollTop,document.body.scrollTop)}};var $Dom=Mstar.Dom;usingNamespace("Mstar").UIHelper={ImgPlayer:function(b,e,d){var a="display";$(b+" > a:first").css(a,"block");$(b+" > a").not(":first").css(a,"none");var c=1,j=false,h=800,i=800,k=500,f=5e3,g=$("#itemCount").val();$(e+">a").each(function(e){$(this).mouseover(function(){var f=" > a:visible",g=$(b+f).prevAll().length;if(e!==g){c=e;$(b+f).find("img").stop(true,true).fadeOut(h,function(){$(b+f).css(a,"none");$(b+" > a").eq(e).css(a,"block").find("img").fadeIn(i)});$(this).addClass(d).siblings("a").removeClass(d)}}).find("div").css("cursor","pointer")});j=setInterval(function(){$(e+">a").eq(c).mouseover();c++;if(c==g)c=0},f)},PagerNavBar:function(u,k,j,r,a,e,x,w){var f=".Load(",h=' <a href="javascript:;" onclick="javascript:',p=' onclick="javascript:',o='<img src="',q=u.TotalCount,b=_PageCount=u.PageCount,c=new StringBuilder;if(a<1)a=1;if(a>b)a=b;var v=(a-1)*PageSize+1,n=a*PageSize;if(n>q)n=q;if(n==0)v=0;if(!(a<=b))a=b;var s=o+$Resource.BuildImage(x)+'" alt="首页" ',t=o+$Resource.BuildImage(w)+'" alt="尾页" ';if(a>1)c.Append(s+p+e+'.Load(1)" />');else c.Append(s+" />");var m=k-(a-1),l=j-(b-a);if(m>0&&l<0)j+=m;if(l>0&&m<0)k+=l;var g=a-k;if(g<1)g=1;var i=a+j;if(i>b)i=b;for(var d=g;d<a;d++)c.Append(h+e+f+d+')">'+d+"</a>");c.Append(h+e+f+d+')"><b>'+a+"</b></a>");for(var d=a+1;d<=i;d++)c.Append(h+e+f+d+')">'+d+"</a>");if(a!=b)c.Append(t+p+e+f+b+')" />');else c.Append(t+" />");c.Append(" 共计<b>"+b+"</b>页");$(r).html("");$(r).html(c.ToString())},AjaxAlert:function(b,c){var a="#globalLoader";$(a).html(c);$(b).block({message:$(a),timeout:1e3})},View3DFlash:function(c,f){var a="#flashViewer",b=new StringBuilder;b.Append("<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' codebase='http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0' width='640' height='480'>");b.Append("<param name='movie' value='"+c+"' />");b.Append("<param name='quality' value='high' />");b.Append("<embed src='"+c+"' quality='high' pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' width='640' height='480'></embed>");b.Append("</object>");$("#flashContainer").html(b.ToString());$("#viewHeader em").html(f);var e=$Dom.AvailWidth(),d=$Dom.AvailHeight();$("#screenWrap").css({width:e,height:d}).show();loginwidth=$(a).width();loginheight=$(a).height();loginleft=($(window).width()-loginwidth)/2;logintop=document.documentElement.scrollTop+($(window).height()-loginheight)/2;$(a).css({top:logintop,left:loginleft}).fadeIn(500);window.onscroll=function(){var b=($(window).width()-loginwidth)/2,c=document.documentElement.scrollTop+($(window).height()-loginheight)/2;$(a).css({top:c,left:b})};window.onresize=function(){var b=($(window).width()-loginwidth)/2,c=document.documentElement.scrollTop+($(window).height()-loginheight)/2;$(a).css({top:c,left:b})}},CloseViewer:function(){$("#flashViewer").fadeOut(500);$("#screenWrap").fadeOut(500)},DirtyWordsFilter:function(d){for(var a=d,c=Mstar.FilterConfig.DirtyWordsList.split(Mstar.FilterConfig.Separator),b=0,e=c.length;b<e;b++)a=$UIHelper.FilterOneWord(a,c[b]);return a},FilterOneWord:function(d,b){var c=d.lastIndexOf(b),a=d;while(c!=-1){a=a.replace(b,Mstar.FilterConfig.SubstituteSymbol);c=a.lastIndexOf(b)}return a},LenLimit:function(c){var b=true,d=/^[A-Za-z0-9]*$/,a=$(c);if(a.val()!=$Resource.BuildContent("ShoppingCart_Letter_PromptText"))if(a.val()!=""){if(!d.test(a.val())&&a.val().length>4){alert("中文4个字以内！");a.focus();return false}else return b;if(a.val().length>9){alert("英文8个字母以内！");a.focus();return false}else return b}else return b;else return b},BuildPopWindow:function(e,d){var c="</div>",b="    </div>",a=new StringBuilder;a.Append('<div id="Popup" class="Popup shadow-one" style="width: 260px;">');a.Append('    <div class="corner-a">');a.Append(b);a.Append('    <div class="corner-b">');a.Append(b);a.Append('    <div class="shadow-two">');a.Append('        <div class="shadow-three">');a.Append('            <div class="shadow-four">');a.Append('                <div class="title">'+e+c);a.Append('                <div class="content">'+d+c);a.Append('                <b class="arrow-tip"></b>');a.Append("            </div>");a.Append("        </div>");a.Append(b);a.Append(c);return a.ToString()}};var $UIHelper=Mstar.UIHelper;
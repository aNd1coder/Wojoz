var dialog=window.parent,oEditor=dialog.InnerDialogLoaded(),FCK=oEditor.FCK,FCKLang=oEditor.FCKLang,FCKConfig=oEditor.FCKConfig,FCKRegexLib=oEditor.FCKRegexLib,FCKTools=oEditor.FCKTools;dialog.AddTab("Info",FCKLang.DlgLnkInfoTab);function OnDialogTabChange(a){ShowE("divInfo",a=="Info");dialog.SetAutoSize(true)}var oParser={},oLink=dialog.Selection.GetSelection().MoveToAncestorNode("A");oLink&&FCK.Selection.SelectNode(oLink);window.onload=function(){LoadSelection();dialog.SetOkButton(true)};function LoadSelection(){if(!oLink)return;var a=oLink.getAttribute("_fcksavedurl");if(a==null)a=oLink.getAttribute("href",2)||"";GetE("linkUrl").value=a;GetE("linkText").value=oLink.innerHTML}function validOk(){if(GetE("linkText").value.length>0)if(GetE("linkUrl").value.length>0)return true;else{alert("请输入链接地址！");GetE("linkUrl").focus();return false}else{alert("请输入文本内容！");GetE("linkText").focus();return false}}function Ok(){if(validOk()){var b,d;oEditor.FCKUndo.SaveUndoStep();b=GetE("linkUrl").value;d=GetE("linkText").value;var a=oLink?[oLink]:oEditor.FCK.CreateLink(b,true),e=a.length>0;if(!e)a=[oEditor.FCK.InsertElement("a")];for(var c=0;c<a.length;c++){oLink=a[c];oLink.href=b;SetAttribute(oLink,"_fcksavedurl",b);oLink.innerHTML=d;SetAttribute(oLink,"target","_blank")}oEditor.FCKSelection.SelectNode(a[0]);return true}};
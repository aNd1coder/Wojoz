var dialog=window.parent,oEditor=dialog.InnerDialogLoaded(),FCK=oEditor.FCK,FCKLang=oEditor.FCKLang,FCKConfig=oEditor.FCKConfig,FCKTools=oEditor.FCKTools;dialog.AddTab("Info",oEditor.FCKLang.DlgInfoTab);var oFakeImage=dialog.Selection.GetSelectedElement(),oEmbed;if(oFakeImage)if(oFakeImage.tagName=="IMG"&&oFakeImage.getAttribute("_fckflash"))oEmbed=FCK.GetRealElement(oFakeImage);else oFakeImage=null;window.onload=function(){oEditor.FCKLanguageManager.TranslatePage(document);LoadSelection();dialog.SetAutoSize(true);dialog.SetOkButton(true);SelectField("txtUrl")};function LoadSelection(){if(!oEmbed)return;GetE("txtUrl").value=GetAttribute(oEmbed,"src","");GetE("txtWidth").value=GetAttribute(oEmbed,"width","");GetE("txtHeight").value=GetAttribute(oEmbed,"height","");GetE("chkAutoPlay").checked=GetAttribute(oEmbed,"play","true")=="true";GetE("chkLoop").checked=GetAttribute(oEmbed,"loop","true")=="true";UpdatePreview()}function Ok(){if(GetE("txtUrl").value.length==0){dialog.SetSelectedTab("Info");GetE("txtUrl").focus();alert(oEditor.FCKLang.DlgAlertUrl);return false}oEditor.FCKUndo.SaveUndoStep();if(!oEmbed){oEmbed=FCK.EditorDocument.createElement("EMBED");oFakeImage=null}UpdateEmbed(oEmbed);if(!oFakeImage){oFakeImage=oEditor.FCKDocumentProcessor_CreateFakeImage("FCK__Flash",oEmbed);oFakeImage.setAttribute("_fckflash","true",0);oFakeImage=FCK.InsertElement(oFakeImage)}oEditor.FCKEmbedAndObjectProcessor.RefreshView(oFakeImage,oEmbed);return true}function UpdateEmbed(a){SetAttribute(a,"type","application/x-shockwave-flash");SetAttribute(a,"pluginspage","http://www.macromedia.com/go/getflashplayer");SetAttribute(a,"src",GetE("txtUrl").value);SetAttribute(a,"width",GetE("txtWidth").value);SetAttribute(a,"height",GetE("txtHeight").value);SetAttribute(a,"id","");SetAttribute(a,"scale","");SetAttribute(a,"play",GetE("chkAutoPlay").checked?"true":"false");SetAttribute(a,"loop",GetE("chkLoop").checked?"true":"false");SetAttribute(a,"menu","true");SetAttribute(a,"title","")}var ePreview;function SetPreviewElement(a){ePreview=a;GetE("txtUrl").value.length>0&&UpdatePreview()}function UpdatePreview(){if(!ePreview)return;while(ePreview.firstChild)ePreview.removeChild(ePreview.firstChild);if(GetE("txtUrl").value.length==0)ePreview.innerHTML="&nbsp;";else{var b=ePreview.ownerDocument||ePreview.document,a=b.createElement("EMBED");SetAttribute(a,"src",GetE("txtUrl").value);SetAttribute(a,"type","application/x-shockwave-flash");SetAttribute(a,"width","100%");SetAttribute(a,"height","100%");ePreview.appendChild(a)}};
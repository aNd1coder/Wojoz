function wordWindow(){this._forms=[];this._getWordObject=_getWordObject;this._wordInputStr=_wordInputStr;this._adjustIndexes=_adjustIndexes;this._isWordChar=_isWordChar;this._lastPos=_lastPos;this.wordChar=/[a-zA-Z]/;this.windowType="wordWindow";this.originalSpellings=[];this.suggestions=[];this.checkWordBgColor="pink";this.normWordBgColor="white";this.text="";this.textInputs=[];this.indexes=[];this.resetForm=resetForm;this.totalMisspellings=totalMisspellings;this.totalWords=totalWords;this.totalPreviousWords=totalPreviousWords;this.getTextVal=getTextVal;this.setFocus=setFocus;this.removeFocus=removeFocus;this.setText=setText;this.writeBody=writeBody;this.printForHtml=printForHtml}function resetForm(){if(this._forms)for(var a=0;a<this._forms.length;a++)this._forms[a].reset();return true}function totalMisspellings(){for(var b=0,a=0;a<this.textInputs.length;a++)b+=this.totalWords(a);return b}function totalWords(a){return this.originalSpellings[a].length}function totalPreviousWords(d,e){for(var c=0,a=0;a<=d;a++)for(var b=0;b<this.totalWords(a);b++)if(a==d&&b==e)break;else c++;return c}function getTextVal(b,c){var a=this._getWordObject(b,c);if(a)return a.value}function setFocus(b,c){var a=this._getWordObject(b,c);if(a)if(a.type=="text"){a.focus();a.style.backgroundColor=this.checkWordBgColor}}function removeFocus(b,c){var a=this._getWordObject(b,c);if(a)if(a.type=="text"){a.blur();a.style.backgroundColor=this.normWordBgColor}}function setText(a,b,c){var d=this._getWordObject(a,b),e,g;if(d){var h=this.indexes[a][b],f=d.value;e=this.textInputs[a].substring(0,h);g=this.textInputs[a].substring(h+f.length,this.textInputs[a].length);this.textInputs[a]=e+c+g;var i=c.length-f.length;this._adjustIndexes(a,b,i);d.size=c.length;d.value=c;this.removeFocus(a,b)}}function writeBody(){var a=window.document,k=false;a.open();for(var b=0;b<this.textInputs.length;b++){var g=0,d=0;a.writeln('<form name="textInput'+b+'">');var e=this.textInputs[b];this.indexes[b]=[];if(e){var f=this.originalSpellings[b];if(!f)break;a.writeln('<div class="plainText">');for(var c=0;c<f.length;c++){do{d=e.indexOf(f[c],g);g=d+f[c].length;if(d==-1)break;var i=e.charAt(d-1),j=e.charAt(g)}while(this._isWordChar(i)||this._isWordChar(j));this.indexes[b][c]=d;for(var h=this._lastPos(b,c);h<d;h++)a.write(this.printForHtml(e.charAt(h)));a.write(this._wordInputStr(f[c]));c==f.length-1&&a.write(printForHtml(e.substr(g)))}a.writeln("</div>")}a.writeln("</form>")}this._forms=a.forms;a.close()}function _lastPos(b,a){return a>0?this.indexes[b][a-1]+this.originalSpellings[b][a-1].length:0}function printForHtml(a){return a}function _isWordChar(a){return a.search(this.wordChar)==-1?false:true}function _getWordObject(a,b){if(this._forms[a])if(this._forms[a].elements[b])return this._forms[a].elements[b];return null}function _wordInputStr(a){var b="<input readonly ";b+='class="blend" type="text" value="'+a+'" size="'+a.length+'">';return b}function _adjustIndexes(b,d,c){for(var a=d+1;a<this.originalSpellings[b].length;a++)this.indexes[b][a]=this.indexes[b][a]+c};